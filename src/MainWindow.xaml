<Window x:Class="LightsOutCube.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LightsOutCube"
        xmlns:mv="clr-namespace:LightsOutCube.ViewModels"
        mc:Ignorable="d"
        Loaded="OnLoaded"
        MouseLeftButtonDown="OnClick"
        Title="Lights Out Cube"
        Height="500" Width="500">
    <DockPanel>
        <Grid Name="MainGrid">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <LinearGradientBrush.GradientStops>
                        <GradientStop Color="{Binding GradientStart}" Offset="0"/>
                        <GradientStop Color="{Binding GradientEnd}" Offset="1"/>
                    </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
            </Grid.Background>
            <Viewport3D Name="CubeViewport" Focusable="True" IsHitTestVisible="True" ClipToBounds="True" Grid.Column="0" Grid.Row="0">
                <Viewport3D.Camera>
                    <PerspectiveCamera x:Name="CubeCamera" Position="0,0,-8" UpDirection="0,1,0" LookDirection="0,0,1" FieldOfView="45" NearPlaneDistance="0.125">
                    </PerspectiveCamera>
                </Viewport3D.Camera>

                <ModelVisual3D x:Name="topModelVisual3D">
                    <ModelVisual3D.Content>
                        <Model3DGroup>
                            <DirectionalLight Color="White" Direction="0,0,1" />
                        </Model3DGroup>
                    </ModelVisual3D.Content>
                </ModelVisual3D>
                <ModelVisual3D>
                    <ModelVisual3D.Transform>
                        <Transform3DGroup x:Name="myTransformGroup" >
                        </Transform3DGroup>
                    </ModelVisual3D.Transform>

                    <ModelVisual3D x:Name="mvModel">
                        <ModelVisual3D.Children>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide01}" Material="{StaticResource Side1Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide02}" Material="{StaticResource Side2Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide03}" Material="{StaticResource Side3Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide04}" Material="{StaticResource Side4Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide05}" Material="{StaticResource Side5Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D Geometry="{StaticResource CubeSide06}" Material="{StaticResource Side6Material}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                            <ModelVisual3D>
                                <ModelVisual3D.Content>
                                    <GeometryModel3D x:Name="myCube" Geometry="{StaticResource myCube}"  Material="{StaticResource myFunkyMaterial}"/>
                                </ModelVisual3D.Content>
                            </ModelVisual3D>
                        </ModelVisual3D.Children>

                        <ModelVisual3D.Transform>
                            <Transform3DGroup >
                                <ScaleTransform3D ScaleX="{Binding CubeSize}"  ScaleY="{Binding CubeSize}" ScaleZ="{Binding CubeSize}" />
                            </Transform3DGroup >
                        </ModelVisual3D.Transform>
                    </ModelVisual3D>

                </ModelVisual3D>
            </Viewport3D>
            <!-- Transparent overlay text. Set IsHitTestVisible='False' so mouse events pass to myViewport. -->
            <TextBlock Name="OverlayText"
                       Text="Drag to rotate — Left mouse"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="White"
                       Opacity="0.85"
                       Margin="12"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Top"
                       Background="Transparent"
                       IsHitTestVisible="False" />

            <!-- Puzzle combo + Reset overlay: bottom-left, transparent background so scene remains visible.
                 Keep IsHitTestVisible='True' so user can interact. -->
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom"
                        Margin="12"
                        Background="Transparent"
                        IsHitTestVisible="True">
                <TextBlock Text="Puzzle:"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Foreground="Gray"
                           Opacity="0.75"
                           VerticalAlignment="Center"
                           Margin="0,0,6,0"
                           ToolTip="Select puzzle" />
                <ComboBox x:Name="PuzzleComboOverlay"
                          ItemsSource="{Binding PuzzleList}"
                          SelectedItem="{Binding SelectedPuzzle, Mode=TwoWay}"
                          Width="70"
                          Background="Transparent"
                          BorderBrush="Transparent"
                          Foreground="Gray"
                          Opacity="0.75"
                          Padding="6"
                          ToolTip="Select puzzle" />
                <Button x:Name="ResetButtonOverlay"
                        Command="{Binding ResetCommand}"
                        Content="Reset"
                        Margin="8,0,0,0"
                        Width="72"
                        Background="Transparent"
                        BorderBrush="White"
                        BorderThickness="1"
                        Foreground="Gray"
                        Opacity="0.75"
                        Padding="6"
                        ToolTip="Reset puzzle" />
            </StackPanel>

            <!-- Solved banner: hidden by default -->
            <TextBlock x:Name="SolvedBanner"
                       Text=""
                       FontSize="28"
                       FontWeight="Bold"
                       Foreground="White"
                       Background="#AA000000"
                       Padding="12,8"
                       Visibility="Collapsed"
                       Opacity="0"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"
                       Margin="0,24,0,0"
                       IsHitTestVisible="False"/>
        </Grid>

    </DockPanel>
</Window>
